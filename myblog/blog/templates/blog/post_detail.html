{% extends 'blog/base.html' %}
{% block title_tag %}{{post.title_tag}}{% endblock title_tag %}
{% block title %}<h1>{{post.title}}</h1>{% endblock title %}
{% block content %}
    <strong>{{post.category}}</strong>
    <br>
    <small>By: {{post.author}} At {{post.pub_date}}</small>
    {% if user.is_authenticated and request.user.id == post.author.id %}
        <br>
        <br>
        <a href="{% url 'post_update' post.pk %}" class="btn btn-primary">Edit</a>
        <a href="{% url 'post_delete' post.pk %}" class="btn btn-danger">Delete</a>
    {% endif %}
    <hr>
    <br>
    {{post.body | safe}}
    <br>
    <br>
    <hr>
    <br>
    {% if user.is_authenticated %}
        <form action="{% url 'like_post' post.pk %}" method="post">{% csrf_token %}
            {% if not liked %}
                <button type="submit" name="post_id" value="{{post.id}}" class="btn btn-primary btn-sm">Like</button> -{{total_likes}} Like
            {% else %}
                <button type="submit" name="post_id" value="{{post.id}}" class="btn btn-danger btn-sm">Unlike</button> -{{total_likes}} Like
            {% endif %}
        </form>
        <br>
    {% else %}
        <small><a href="{% url 'login' %}">Log in</a> first to like the post</small>
        <br>
    {% endif %}
    <a href="{% url 'post_list'%}" class="btn btn-secondary">Go Back</a>
{% endblock content %}